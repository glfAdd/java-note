##### TODO

```
https://www.cnblogs.com/wl20200316/p/12579982.html 单例



```



### @Component 

```

```



### @Configuration

表示类作为 bean 定义的源



##### Configuration 底层定义

```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Component
public @interface Configuration {
    @AliasFor(
        annotation = Component.class
    )
    String value() default "";

    boolean proxyBeanMethods() default true;
}
```

### @Bean

注解的方法返回的类型都会直接注册为 bean

```

```





### @ConfigurationProperties

@ConfigurationProperties 和 @value 有着相同的功能, 但 @ConfigurationProperties 的写法更为方便

@ConfigurationProperties 的 POJO 类的成员变量名称必须和 prefix 的后缀名要一致, 不然值会绑定不上. 特殊的后缀名是 "driver-class-name" 这种带横杠的情况, 在POJO里面的命名规则是"下划线转驼峰"就可以绑定成功，所以就是 "driver-class-name"

##### 例子 1

application.properties

```properties
spring.datasource.username=root
```

DatasourcePro.java

```java
@ConfigurationProperties(prefix = "spring.datasource")
@Component
public class DatasourcePro {
    private String username;
    
    public String getUsername() {
        return username;
    }
    
    public void setUsername(String username) {
        this.username = username;
    }
}
```

AbaController.java

```java
@Controller
@RequestMapping(value = "/config")
public class AbaController {
    @Autowired
    private DatasourcePro datasourcePro;
    
    @RequestMapping("/test")
    @ResponseBody
    public Map<String, Object> test(){
        Map<String, Object> map = new HashMap<>();
        map.put("userName", datasourcePro.getUsername());
        return map;
    }
}
```

##### 例子 2

application.properties

```yaml
spring.datasource.druid.write.url=jdbc:mysql://localhost:3306/jpa
spring.datasource.druid.write.username=root
spring.datasource.druid.write.password=1
spring.datasource.druid.write.driver-class-name=com.mysql.jdbc.Driver

spring.datasource.druid.read.url=jdbc:mysql://localhost:3306/jpa
spring.datasource.druid.read.username=root
spring.datasource.druid.read.password=1
spring.datasource.druid.read.driver-class-name=com.mysql.jdbc.Driver
```

AbaController.java

```java
// 类用 @Configuration
// 方法用 @Bean 和 @ConfigurationProperties

@Configuration
public class AbaController {
    @ConfigurationProperties(prefix = "spring.datasource.druid.read")
    @Bean(name = "readDruidDataSource")
    public DataSource readDruidDataSource() {
        return new DruidDataSource();
    }

    @ConfigurationProperties(prefix = "spring.datasource.druid.write")
    @Bean(name = "writeDruidDataSource")
    @Primary
    public DataSource writeDruidDataSource() {
        return new DruidDataSource();
    }
}
```

### @Validator

##### 步骤

```
1. 解析请求参数时加上 @Valid
2. 定义统一处理 response 的类
3. @ControllerAdvice 给控制器添加方法
4. @ExceptionHandler 捕获异常
5. 解析异常返回数据




```



##### Hibernate Validator

| 校验注解  | 数据类型                                  |                                                              |
| --------- | ----------------------------------------- | ------------------------------------------------------------ |
| @NotNull  | 任意类型                                  | 不为null                                                     |
| @Null     | 任意类型                                  | 是null                                                       |
| @NotBlank | 字符串                                    | 字符串不为空（不为null、去除首位空格后长度不为0）            |
| @NotEmpty | CharSequence子类型、Collection、Map、数组 | 验证注解的元素值不为null且不为空（字符串长度不为0，集合大小不为0 |



```
@Valid	任何非原子类型，级联验证。比如验证User对象的属性Address对象	指定递归验证关联的对象如用户对象中有个地址对象属性，如果想在验证用户对象时一起验证地址对象，在地址对象上加@Valid注解即可级联验证。
@AssertFalse	Boolean，boolean	验证注解的元素值是false
@AssertTrue	Boolean，boolean	验证注解的元素值是true
@Min(value=xxx)	BigDecimal，BigInteger，byte，short，int，long，等任何Number或CharSequence（存储的是数字）子类型，，	验证注解的元素值大于等于@Min指定的value值
@Max(value=xxx)	和@Min要求一样	验证注解的元素值小于等于@Max指定的value值
@DecimalMax(value=xxx)	和@Min要求一样	验证注解的元素值小于等于@DecimalMax指定的value值
@DecimalMin(value=xxx)	和@Min要求一样	

验证注解的元素值大于等于@DecimalMin指定的value值
@Digits(integer=整数位数，fraction=小数位数)	和@Min要求一样	验证注解的元素值的整数位数和小数位数的上限
@Size(min=下限，max=上限)	字符串、Collection、Map、数组等	验证注解的元素值在min和max（包含）指定区间之内，如字符长度、集合大小
@Past	java.util.Date，java.util.Calendar，Joda Time类库的日期类型	验证注解的元素值（日期类型）比当前时间早
@Future	与@Past要求一样	验证注解的元素值（日期类型）比当前时间晚
@Length(min=下限，max=上限)	CharSequence子类型	验证注解的元素值长度在min和max区间内
@Range(min=最小值，max=最大值)	BigDecimal，BigInteger，CharSequence，byte，short，int，long等原子类型和包装类型	验证注解的元素值在最小值和最大值之间
@Email(regexp=正则表达式，flag=标志的模式)	CharSequence子类型（如String）	验证注解的元素值是Email，也可以通过regexp和flag指定自定义的email格式
@Pattern(regexp=正则表达式，flag=标志的模式)	String，任何CharSequence的子类型	验证注解的元素值与指定的正则表达式匹配

```

##### spring 校验

```
@Validated      	任何非原子类  	@Valid：没有分组的功能; @Valid：可以用在方法、构造函数、方法参数和成员属性（字段）上; @Validated：提供了一个分组功能，可以在入参验证时，根据不同的分组采用不同的验证机制; @Validated：可以用在类型、方法和方法参数上。但是不能用在成员属性（字段）上; 两者是否能用于成员属性（字段）上直接影响能否提供嵌套验证的功能。

```

### @Value

##### 作用

@Value 是 Spring 框架功能, 作用是通过注解将常量, 配置文件中的值, 其他bean的属性值注入到变量中，作为变量的初始值

##### 常量注入

配置不灵活, 功能变更需要修改代码

```java
// 注入普通字符串
@Value("Jack")
private String username; 

// 注入文件资源
@Value("classpath:com/test/config.xml")
private Resource resource; 

// 注入URL资源
@Value("http://www.baidu.com")
private Resource url; 
```

##### 读取配置文件

读取配置文件的值，注入到变量中去. 配置文件分为默认配置文件 application.properties 和自定义配置文件.

application.yml 文件

```yaml
myUserName: 张三
```

java

```java
@Value("${myUserName}")
private String myUserName;
```

##### 读取 bean 属性

bean 对象

```java
@Data
@Component
public class User {
    private String id;
    private String username;
}
```

java

```java
@Value("#{user.username}")
private String username;
```

##### 默认值

如果` a.b.c` 不存在, `aa bb` 为默认值

```java
@Value("${a.b.c:aa bb}")
private String name;

// 默认值为空
@Value("${a.b.c:}")
private String name;
```

##### 声明变量时

```java
public static class FieldValueTestBean {
    @Value("#{ systemProperties['user.region'] }")
    private String defaultLocale;
}
```

##### setter 中

```java
public static class PropertyValueTestBean {
    private String defaultLocale;
    @Value("#{ systemProperties['user.region'] }")
    public void setDefaultLocale(String defaultLocale) {
        this.defaultLocale = defaultLocale;
    }
}
```

##### 方法中

```java
public class SimpleMovieLister {
    private MovieFinder movieFinder;
    private String defaultLocale;
    @Autowired
    public void configure(MovieFinder movieFinder,
            @Value("#{ systemProperties['user.region'] }") String defaultLocale) {
        this.movieFinder = movieFinder;
        this.defaultLocale = defaultLocale;
    } 
}
```

##### 构造方法

```java
public class MovieRecommender {
    private String defaultLocale;
    private CustomerPreferenceDao customerPreferenceDao;
    @Autowired
    public MovieRecommender(CustomerPreferenceDao customerPreferenceDao,
            @Value("#{systemProperties['user.country']}") String defaultLocale) {
        this.customerPreferenceDao = customerPreferenceDao;
        this.defaultLocale = defaultLocale;
    }
}
```

##### 数据类型

```java
// 基本类型
@Value("${some.key:true}")
private boolean booleanWithDefaultValue;
// 包装类型
@Value("${some.key:true}")
private Boolean booleanWithDefaultValue;
// 数组
@Value("${some.key:1,2,3}")
private int[] intArrayWithDefaults;
```

##### 指定配置文件

```java
@PropertySources(value={
    @PropertySource(value={"classpath:xxx.properties"}),
    @PropertySource(value={"classpath:yyy.properties"}),
})
public static class FieldValueTestBean {
    @Value("#{ systemProperties['user.region'] }")
    private String defaultLocale;
}


@PropertySource(value = "classpath:daoconfig/datasource-config.properties")
public static class FieldValueTestBean {
    @Value("#{ systemProperties['user.region'] }")
    private String defaultLocale;
}
```

### @Primary

```



```



### @SuppressWarnings

##### 作用

告诉编译器忽略指定的警告，不用在编译完成后出现警告信息

可以标注在类、字段、方法、参数、构造方法, 局部变量

##### 用法

```
@SuppressWarnings("")
@SuppressWarnings({})
@SuppressWarnings(value={}

@SuppressWarnings("unchecked")
@SuppressWarnings("unchecked", "deprecation")
@SuppressWarnings({"unchecked", "deprecation"})
@SuppressWarnings(value={"unchecked", "deprecation"})
```

##### 类型

| 关键字                   | 用途                                                         |
| ------------------------ | ------------------------------------------------------------ |
| all                      | to suppress all warnings（抑制所有警告）                     |
| boxing                   | to suppress warnings relative to boxing/unboxing operations（要抑制与箱/非装箱操作相关的警告） |
| cast                     | to suppress warnings relative to cast operations（为了抑制与强制转换操作相关的警告） |
| dep-ann                  | to suppress warnings relative to deprecated annotation（要抑制相对于弃用注释的警告） |
| deprecation              | to suppress warnings relative to deprecation（要抑制相对于弃用的警告） |
| fallthrough              | to suppress warnings relative to missing breaks in switch statements（在switch语句中，抑制与缺失中断相关的警告） |
| finally                  | to suppress warnings relative to finally block that don’t return（为了抑制警告，相对于最终阻止不返回的警告） |
| hiding                   | to suppress warnings relative to locals that hide variable（为了抑制本地隐藏变量的警告） |
| incomplete-switch        | to suppress warnings relative to missing entries in a switch statement (enum case)（为了在switch语句（enum案例）中抑制相对于缺失条目的警告） |
| nls                      | to suppress warnings relative to non-nls string literals（要抑制相对于非nls字符串字面量的警告） |
| null                     | to suppress warnings relative to null analysis（为了抑制与null分析相关的警告） |
| rawtypes                 | to suppress warnings relative to un-specific types when using generics on class params（在类params上使用泛型时，要抑制相对于非特异性类型的警告） |
| restriction              | to suppress warnings relative to usage of discouraged or forbidden references（禁止使用警告或禁止引用的警告） |
| serial                   | to suppress warnings relative to missing serialVersionUID field for a serializable class（为了一个可串行化的类，为了抑制相对于缺失的serialVersionUID字段的警告） |
| static-access            | o suppress warnings relative to incorrect static access（o抑制与不正确的静态访问相关的警告） |
| synthetic-access         | to suppress warnings relative to unoptimized access from inner classes（相对于内部类的未优化访问，来抑制警告） |
| unchecked                | to suppress warnings relative to unchecked operations（相对于不受约束的操作，抑制警告） |
| unqualified-field-access | to suppress warnings relative to field access unqualified（为了抑制与现场访问相关的警告） |
| unused                   | to suppress warnings relative to unused code（抑制没有使用过代码的警告） |

##### 例子

```java
@SuppressWarnings("unchecked")
public void addItems(String item) {
    @SuppressWarnings("rawtypes")
    List items = new ArrayList();
    items.add(item);
}
```

